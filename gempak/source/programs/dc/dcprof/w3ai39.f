        SUBROUTINE W3AI39 (NFLD, N)
C$$$    SUBPROGRAM DOCUMENTATION  BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    W3AI39      TRANSLATE 'ASCII' FIELD TO 'EBCDIC'
C   PRGMMR: DESMARAIS        ORG: W342       DATE: 93-10-06
C
C ABSTRACT: TRANSLATE AN 'ASCII' FIELD TO 'EBCDIC', ALL ALPHANUMERICS,
C   SPECIAL CHARCATERS, FILL SCATTER, BROCKEN< CLEAR, OVERCAST, BELL,
C   HT AND VT (FOR AFOS). SPACE, '6D' TO '5E' CONVERSION (HDROLOGY),
C   CHANGERS WERE MADE TO W3AI38 TO GIVE REVERSE TABLE TRANSLATION
C
C PROGRAM HISTORY LOG:
C   93-10-06  R.E.JONES   CONVERT IBM370 ASSEBLER VERSION TO FORTRAN
C
C USAGE:    CALL W3AI39 (NFLD,N)
C   INPUT ARGUMENT LIST:
C     NFLD    - CHARACTER*1 ARRAY OF ASCII DATA
C     N       - INTEGER,  CONTAINS CHARACTER COUNT TO CONVERT....
C
C   OUTPUT ARGUMENT LIST:
C     NFLD     - CHARACTER*1 ARRAY OF EBCDIC DATA
C
C REMARKS: SOFTWARE VERSION OF IBM370 TRANSLATE INSTRUCTION, BY
C   CHANGING THE TABLE WE COULD DO A  64, 96,  ASCII
C   CHARACTER SET, CHANGE LOWER CASE TO UPPER, ETC.
C
C ATTRIBUTES:
C   LANGUAGE: SiliconGraphics 3.5 FORTRAN 77
C   MACHINE:  SiliconGraphics IRIS-4D/25, 35, INDIGO, Indy
C
C$$$
C
      CHARACTER * 1  NFLD(*)
      BYTE  EBCDIC(0:255)
C
      SAVE
C
C***  EBCDIC CONTAINS HEX. REPRESENTATION OF EBCDIC CHARACTERS
C
      DATA  EBCDIC /
     + Z'00',Z'7D',Z'00',Z'6C',Z'00',Z'00',Z'00',Z'E0',
     & Z'00',Z'65',Z'7C',Z'66',Z'00',Z'4C',Z'00',Z'00',
     & Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',
     & Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'5B',Z'00',
     & Z'40',Z'D0',Z'7F',Z'7B',Z'50',Z'00',Z'50',Z'6E',
     & Z'4D',Z'5D',Z'5C',Z'4F',Z'6B',Z'60',Z'4B',Z'61',
     & Z'F0',Z'F1',Z'F2',Z'F3',Z'F4',Z'F5',Z'F6',Z'F7',
     & Z'F8',Z'F9',Z'00',Z'00',Z'00',Z'7E',Z'00',Z'C0',
     & Z'64',Z'C1',Z'C2',Z'C3',Z'C4',Z'C5',Z'C6',Z'C7',
     & Z'C8',Z'C9',Z'D1',Z'D2',Z'D3',Z'D4',Z'D5',Z'D6',
     & Z'D7',Z'D8',Z'D9',Z'E2',Z'E3',Z'E4',Z'E5',Z'E6',
     & Z'E7',Z'E8',Z'E9',Z'00',Z'62',Z'63',Z'6D',Z'00',
     & Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',
     & Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',
     & Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',
     & Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'00',Z'5F',
     & 128*Z'00'/
c       DATA  EBCDIC /
c     + '00'Z,'7D'Z,'00'Z,'6C'Z,'00'Z,'00'Z,'00'Z,'E0'Z,
c     & '00'Z,'65'Z,'7C'Z,'66'Z,'00'Z,'4C'Z,'00'Z,'00'Z,
c     & '00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,
c     & '00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'5B'Z,'00'Z,
c     & '40'Z,'D0'Z,'7F'Z,'7B'Z,'50'Z,'00'Z,'50'Z,'6E'Z,
c     & '4D'Z,'5D'Z,'5C'Z,'4F'Z,'6B'Z,'60'Z,'4B'Z,'61'Z,
c     & 'F0'Z,'F1'Z,'F2'Z,'F3'Z,'F4'Z,'F5'Z,'F6'Z,'F7'Z,
c     & 'F8'Z,'F9'Z,'00'Z,'00'Z,'00'Z,'7E'Z,'00'Z,'C0'Z,
c     & '64'Z,'C1'Z,'C2'Z,'C3'Z,'C4'Z,'C5'Z,'C6'Z,'C7'Z,
c     & 'C8'Z,'C9'Z,'D1'Z,'D2'Z,'D3'Z,'D4'Z,'D5'Z,'D6'Z,
c     & 'D7'Z,'D8'Z,'D9'Z,'E2'Z,'E3'Z,'E4'Z,'E5'Z,'E6'Z,
c     & 'E7'Z,'E8'Z,'E9'Z,'00'Z,'62'Z,'63'Z,'6D'Z,'00'Z,
c     & '00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,
c     & '00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,
c     & '00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,
c     & '00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'00'Z,'5F'Z,
c     & 128*'00'Z/
C
C      TABLE FOR CRAY
C
C      DATA  EBCDIC /
C    & X'007D006C000000E0',X'00657C66004C0000',
C    & X'0000000000000000',X'0000000000005B00',
C    & X'40D07F7B5000506E',X'4D5D5C4F6B604B61',
C    & X'F0F1F2F3F4F5F6F7',X'F8F90000007E00C0',
C    & X'64C1C2C3C4C5C6C7',X'C8C9D1D2D3D4D5D6',
C    & X'D7D8D9E2E3E4E5E6',X'E7E8E90062636D00',
C    & X'0000000000000000',X'0000000000000000',
C    & X'0000000000000000',X'000000000000005F',
C    & 16 * X'0000000000000000'/
C
C
      IF (N .LE. 0)   RETURN
C
C***  CONVERT STRING ...  ASCII TO EBCDIC,   NUM CHARACTERS
C
        DO  20  J = 1, N
          NFLD(J) = CHAR(INT(EBCDIC(ICHAR(NFLD(J)))))
 20     CONTINUE
C
      RETURN
      END
